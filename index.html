<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <title>Aktörskarta – Fellesrådet för Trøndelag och Jämtland Härjedalen</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
    <style>
        body { font-family: Arial, sans-serif; margin:0; padding:0; }
        h1 { text-align:center; margin: 10px 0; }
        #dropdown { margin: 10px auto; width: 90%; max-width: 600px; display:block; }
        #map { height: 90vh; width: 100%; }
        optgroup { font-weight:bold; }
        /* Färger för optioner (flyttas till JS) */
        .red { color: red; }
        .blue { color: blue; }
        .yellow { color: goldenrod; }
        .green { color: green; }
        .orange { color: orange; }
    </style>
</head>
<body>
<h1>Aktörskarta – Fellesrådet för Trøndelag och Jämtland Härjedalen</h1>
<select id="dropdown">
    <option value="">-- Välj aktör --</option>
</select>
<div id="map"></div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script>
const map = L.map('map').setView([63.0, 12.5], 6);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 18, attribution: '© OpenStreetMap' }).addTo(map);

// Färger för kategorier
const categoryColors = {
    "Näringslivsorganisationer - Jämtland Härjedalen":"red",
    "Näringslivsorganisationer - Trøndelag":"red",
    "Offentliga aktörer - Jämtland Härjedalen":"blue",
    "Offentliga aktörer - Trøndelag":"blue",
    "Universitet, utbildnings och forskningsmiljöer - Jämtland Härjedalen":"yellow",
    "Universitet, utbildnings och forskningsmiljöer - Trøndelag":"yellow",
    "Gränsöverskridande samarbeten regionalt":"green",
    "Gränsöverskridande samarbeten Norge - Sverige":"green",
    "Europeiska och nordiska samarbeten":"green",
    "Nordens gränskommittéer":"green",
    "Nätverk för kompetens, kapital och företagande - Trøndelag":"green",
    "Nätverk för kompetens, kapital och företagande - Jämtland Härjedalen":"green",
    "Civilsamhället kultur - Trøndelag":"orange",
    "Civilsamhället kultur - Jämtland Härjedalen":"orange",
    "Kulturevent - Trøndelag":"orange",
    "Kulturevent - Jämtland Härjedalen":"orange",
    "Sportevent - Trøndelag":"orange",
    "Sportevent - Jämtland Härjedalen":"orange",
    "Finansiering":"green"
};

// Komplett aktörslista (exklusive de fem enskilda företagen)
const actors = [
    // (Samma lista som tidigare)
];

// Skapa grupper i drop-down
const dropdown = document.getElementById("dropdown");
const grouped = {};
actors.forEach(actor => {
    if(!grouped[actor.category]) grouped[actor.category] = [];
    grouped[actor.category].push(actor);
});

// Lägg till optgroup och options med färg
Object.keys(grouped).sort().forEach(category => {
    const optgroup = document.createElement("optgroup");
    optgroup.label = category;
    grouped[category].sort((a,b) => a.name.localeCompare(b.name)).forEach(actor => {
        const option = document.createElement("option");
        option.value = `${actor.lat},${actor.lon}`;
        option.text = actor.name;
        option.className = categoryColors[category]; // färg på texten
        optgroup.appendChild(option);
    });
    dropdown.appendChild(optgroup);
});

// Lägg till markörer
actors.forEach(actor => {
    const marker = L.circleMarker([actor.lat, actor.lon], {
        radius: 8,
        color: categoryColors[actor.category],
        fillOpacity: 0.8
    }).addTo(map);
    marker.bindPopup(`<b>${actor.name}</b><br>${actor.category}`);
});

// Zooma till vald aktör
dropdown.addEventListener("change", function() {
    if(this.value){
        const coords = this.value.split(",");
        map.setView([parseFloat(coords[0]), parseFloat(coords[1])], 10);
    }
});
</script>
</body>
</html>
