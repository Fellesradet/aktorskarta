<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aktörskarta - Fellesrådet</title>
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-sA+e2wSfnP5Qgn3LCJm5jflHc6F1v8kGGlT5T0Sk7oM=" crossorigin=""/>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, sans-serif;
        }
        #container {
            display: flex;
            height: 100vh;
        }
        #sidebar {
            width: 350px;
            padding: 20px;
            background-color: #f4f4f4;
            overflow-y: auto;
            box-sizing: border-box;
        }
        #map {
            flex: 1;
        }
        h1 {
            font-size: 20px;
            margin-bottom: 10px;
        }
        select, label {
            display: block;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .actor-item {
            margin-bottom: 10px;
            padding: 5px;
            border-left: 5px solid #333;
            background-color: #fff;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div id="container">
    <div id="sidebar">
        <h1>Filtrera aktörer</h1>
        <label for="filterKategori">Kategori</label>
        <select id="filterKategori">
            <option value="Alla">Alla</option>
        </select>

        <label for="filterRegion">Region</label>
        <select id="filterRegion">
            <option value="Alla">Alla</option>
        </select>

        <div id="actorList"></div>
    </div>
    <div id="map"></div>
</div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-o9N1j7kIht5aYX0m36g+poozM0gfrPTzYhEVuX1kPtY=" crossorigin=""></script>

<script>
    // --- Din data ---
    const actors = [
        {"Område":"Näringslivsorganisationer - Jämtland Härjedalen","Kategori":"Näringsliv","Organisation":"Samling Näringsliv","Lat":63.17917,"Lon":14.63583,"Region":"Jämtland","Säte":"Östersund","Färgkod":"red"},
        {"Område":"Näringslivsorganisationer - Jämtland Härjedalen","Kategori":"Näringsliv","Organisation":"IUC Jämtland Härjedalen","Lat":63.17917,"Lon":14.63583,"Region":"Jämtland","Säte":"Östersund","Färgkod":"red"},
        {"Område":"Näringslivsorganisationer - Trøndelag","Kategori":"Näringsliv","Organisation":"NHO Næringslivets Hovedorganisasjon","Lat":63.44683,"Lon":10.42191,"Region":"Trøndelag","Säte":"Trondheim","Färgkod":"red"},
        {"Område":"Näringslivsorganisationer - Trøndelag","Kategori":"Näringsliv","Organisation":"Næringsforeningen i Trondheimsregionen (NiT)","Lat":63.44683,"Lon":10.42191,"Region":"Trøndelag","Säte":"Trondheim","Färgkod":"red"},
        {"Område":"Offentliga aktörer - Trøndelag","Kategori":"Offentlig sektor","Organisation":"Statsforvalteren","Lat":63.44683,"Lon":10.42191,"Region":"Trøndelag","Säte":"Trondheim","Färgkod":"blue"},
        {"Område":"Offentliga aktörer - Trøndelag","Kategori":"Offentlig sektor","Organisation":"Helse Midt-Norge RHF","Lat":64.01519,"Lon":11.49526,"Region":"Trøndelag","Säte":"Steinkjer","Färgkod":"blue"},
        {"Område":"Offentliga aktörer - Jämtland Härjedalen","Kategori":"Offentlig sektor","Organisation":"Länsstyrelsen","Lat":63.17917,"Lon":14.63583,"Region":"Jämtland","Säte":"Östersund","Färgkod":"blue"},
        {"Område":"Offentliga aktörer - Jämtland Härjedalen","Kategori":"Offentlig sektor","Organisation":"Arbetsförmedlingen","Lat":63.17917,"Lon":14.63583,"Region":"Jämtland","Säte":"Östersund","Färgkod":"blue"},
        {"Område":"Universitet, utbildnings och forskningsmiljöer - Jämtland Härjedalen","Kategori":"Utbildning","Organisation":"Mittuniversitetet (MIUN)","Lat":63.17917,"Lon":14.63583,"Region":"Jämtland","Säte":"Östersund","Färgkod":"yellow"},
        {"Område":"Universitet, utbildnings och forskningsmiljöer - Jämtland Härjedalen","Kategori":"Utbildning","Organisation":"Hushållningssällskapet","Lat":63.17917,"Lon":14.63583,"Region":"Jämtland","Säte":"Östersund","Färgkod":"yellow"},
        {"Område":"Universitet, utbildnings och forskningsmiljöer - Trøndelag","Kategori":"Utbildning","Organisation":"Norwegian University of Science and Technology NTNU","Lat":63.44683,"Lon":10.42191,"Region":"Trøndelag","Säte":"Trondheim","Färgkod":"yellow"},
        {"Område":"Universitet, utbildnings och forskningsmiljöer - Trøndelag","Kategori":"Utbildning","Organisation":"NTNU:s Næringslivsringer","Lat":63.44683,"Lon":10.42191,"Region":"Trøndelag","Säte":"Trondheim","Färgkod":"yellow"},
        {"Område":"Gränsöverskridande samarbeten regionalt","Kategori":"Samarbeten","Organisation":"Gränsräddningsrådet Nordred","Lat":59.3293,"Lon":18.0686,"Region":"Jämtland","Säte":"Stockholm","Färgkod":"green"},
        {"Område":"Gränsöverskridande samarbeten regionalt","Kategori":"Samarbeten","Organisation":"Samarbete mellan polisen","Lat":61.8230,"Lon":12.0380,"Region":"Trøndelag","Säte":"Vauldalen","Färgkod":"green"},
        {"Område":"Finansiering","Kategori":"Finansiering","Organisation":"Interreg Sverige Norge Nordens gröna bälte","Lat":63.17917,"Lon":14.63583,"Region":"Jämtland","Säte":"Östersund","Färgkod":"purple"},
        {"Område":"Finansiering","Kategori":"Finansiering","Organisation":"Interreg Aurora","Lat":65.5848,"Lon":22.1567,"Region":"Jämtland","Säte":"Luleå","Färgkod":"purple"}
        // Du kan lägga till resterande aktörer här på samma sätt
    ];

    // --- Skapa karta ---
    const map = L.map('map').setView([63.0, 12.0], 6);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // --- Skapa markörer ---
    const markers = [];
    actors.forEach(actor => {
        const marker = L.circleMarker([actor.Lat, actor.Lon], {
            color: actor.Färgkod,
            radius: 8,
            fillOpacity: 0.8
        }).addTo(map).bindPopup(
            `<b>${actor.Organisation}</b><br>
             Område: ${actor.Område}<br>
             Kategori: ${actor.Kategori}<br>
             Region: ${actor.Region}<br>
             Säte: ${actor.Säte}`
        );
        marker.actor = actor; // För filtrering
        markers.push(marker);
    });

    // --- Skapa filterlistor ---
    const kategoriSet = new Set(actors.map(a => a.Kategori));
    const filterKategori = document.getElementById('filterKategori');
    kategoriSet.forEach(k => {
        const opt = document.createElement('option');
        opt.value = k;
        opt.textContent = k;
        filterKategori.appendChild(opt);
    });

    const regionSet = new Set(actors.map(a => a.Region));
    const filterRegion = document.getElementById('filterRegion');
    regionSet.forEach(r => {
        const opt = document.createElement('option');
        opt.value = r;
        opt.textContent = r;
        filterRegion.appendChild(opt);
    });

    // --- Funktion för filtrering ---
    function updateFilter() {
        const selectedKategori = filterKategori.value;
        const selectedRegion = filterRegion.value;
        const listDiv = document.getElementById('actorList');
        listDiv.innerHTML = '';

        markers.forEach(marker => {
            const matchKategori = selectedKategori === 'Alla' || marker.actor.Kategori === selectedKategori;
            const matchRegion = selectedRegion === 'Alla' || marker.actor.Region === selectedRegion;

            if (matchKategori && matchRegion) {
                marker.addTo(map);
                // Lista i sidopanel
                const div = document.createElement('div');
                div.className = 'actor-item';
                div.style.borderLeftColor = marker.actor.Färgkod;
                div.innerHTML = `<b>${marker.actor.Organisation}</b><br>${marker.actor.Område}`;
                div.onclick = () => {
                    map.setView([marker.actor.Lat, marker.actor.Lon], 10);
                    marker.openPopup();
                };
                listDiv.appendChild(div);
            } else {
                map.removeLayer(marker);
            }
        });
    }

    filterKategori.addEventListener('change', updateFilter);
    filterRegion.addEventListener('change', updateFilter);

    // Kör initial filter
    updateFilter();

</script>
</body>
</html>
